<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.first.mapper.CartMapper">
	<!-- Author : 이동윤 고객장바구니 리스트 -->
	<select id="selectcartList" resultType="Map">
		select 
			c.cart_no,
		    c.goods_no,
		    c.cart_amount,
		    g.goods_title,
		    g.goods_memo,
		    g.goods_price,
		    g.goods_state,
		    ca.category_title,
		    gf.goods_file_name,
		    gf.goods_file_ext,
		    (c.cart_amount * g.goods_price) total_price
		from cart c 
		inner join goods g on c.goods_no = g.goods_no
		inner join goods_category gc on gc.goods_no = g.goods_no
		inner join category ca on gc.category_no = ca.category_no
		left join (select 
						goods_no, min(goods_file_name) goods_file_name, min(goods_file_ext) goods_file_ext
					from goods_file
		            group by goods_no) gf on gf.goods_no = g.goods_no
		where c.customer_mail = #{customerMail}     
	</select>
</mapper>